---
  - name: NGINX | Installing NGINX repo rpm
    yum:
      name: http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm
    sudo: yes

  - name: NGINX | Installing NGINX
    yum:
      name: nginx
      state: latest
    sudo: yes
  - name: NGINX | Starting NGINX
    service:
      name: nginx
      state: started
    sudo: yes
  - name: Update nginx conf
    template: >
        src=my_server.conf.j2
        dest=/etc/nginx/conf.d/my_server.conf
        backup=yes
    sudo: yes
  - name: NGINX | Restart NGINX
    service:
      name: nginx
      state: restarted
    sudo: yes